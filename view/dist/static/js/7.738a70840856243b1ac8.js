webpackJsonp([7],{211:function(e,i,n){n(293);var t=n(0)(n(253),n(546),null,null);e.exports=t.exports},253:function(e,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=n(33),a=n.n(t);i.default={name:"user",data:function(){return{userInfo:null}},computed:{user:function(){return this.$store.state.user},account:function(){return this.$route.params.account||""},isSelf:function(){return!this.account||this.account===this.user.account}},methods:{getUser:function(){var e=this;this.$graphql.query("\n        user ($account) {\n          ...user\n        }\n      ",{account:this.account},["user"]).then(function(i){if(!i)return e.$toast("未找到该用户","error");e.userInfo=i}).catch(function(i){return e.$toast(i.message,"error")})},updateUser:function(){var e=this,i=this.userInfo,n=i.profile,t=i.website,a=i.github,o=i.location,s=i.avatar;this.$graphql.mutation("\n        updateUser ($profile, $website, $github, $location, $avatar) {\n          ...user\n        }\n      ",{avatar:s,profile:n,website:t,github:a,location:o},["user"]).then(function(i){e.$toast("保存成功","success"),e.$store.commit("updateAvatar",i.avatar)}).catch(function(i){return e.$toast(i.message,"error")})},bindEmail:function(){var e=this,i=this.userInfo,n=i.account,t=i.email;this.$http.post("/sendSignupEmail",{account:n,email:t}).then(function(i){e.$toast("已向注册邮箱发送激活邮件","success")}).catch(function(i){e.$toast(i.message,"error")})},uploadAvatar:function(e){var i=this,n=e.target.files[0];if(!n)return!1;var t=new FileReader;t.onload=function(e){i.compress(e.target.result).then(function(e){i.userInfo.avatar=e})},t.readAsDataURL(n)},compress:function(e){return new a.a(function(i){var n={width:168,height:168,quality:.92},t=new Image,a=document.createElement("CANVAS");a.width=n.width,a.height=n.height;var o=a.getContext("2d");t.onload=function(){var e=[t.width,t.height],s=void 0,r=void 0,A=void 0;e[0]>e[1]?(r=0,s=(e[0]-e[1])/2,A=e[1]):(s=0,r=(e[1]-e[0])/2,A=e[0]),o.drawImage(t,s,r,A,A,0,0,n.width,n.height),i(a.toDataURL("image/jpeg",n.quality))},t.src=e})}},mounted:function(){this.getUser()}}},275:function(e,i,n){i=e.exports=n(195)(!0),i.push([e.i,".user-view{height:100vh;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;overflow:hidden}.user-view,.user-view .user-group{display:-webkit-box;display:-ms-flexbox;display:flex}.user-view .user-group{width:800px;padding:20px;margin:200px 0}.user-view .user-group .title{margin-bottom:12px}.user-view .user-info{-webkit-box-flex:1;-ms-flex:1;flex:1;margin-right:120px;flex-direction:column}.user-view .user-info,.user-view .user-info .user-info-item{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column}.user-view .user-info .user-info-item{position:relative;margin-bottom:15px;flex-direction:column}.user-view .user-info .user-info-item label{width:70px;font-size:14px;margin-bottom:5px}.user-view .user-info .user-info-item input{width:100%;height:34px;padding:6px 8px;font-size:14px;color:#333;line-height:20px;vertical-align:middle;background-color:#fafafa;border:1px solid #ddd;border-radius:4px;box-shadow:inset 0 1px 2px rgba(0,0,0,.075)}.user-view .user-info .user-info-item input:focus{border-color:#51a7e8;outline:none;box-shadow:inset 0 1px 2px rgba(0,0,0,.075),0 0 5px rgba(81,167,232,.5)}.user-view .user-info .user-info-item input[disabled]{opacity:.75;background-color:#f1f1f1}.user-view .user-info .user-info-item .has-btn-item{display:-webkit-box;display:-ms-flexbox;display:flex}.user-view .user-info .user-info-item .has-btn-item input{border-radius:3px 0 0 3px}.user-view .user-info .user-info-item .has-btn-item button{border-radius:0 3px 3px 0}.user-view .user-avatar{width:168px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.user-view .user-avatar .avatar{width:168px;height:168px;border-radius:3px;margin-bottom:10px}.user-view .save-btn{-ms-flex-item-align:start;align-self:flex-start;padding:0 20px;margin-bottom:40px;border:none;color:#fff;background-color:#eee;background-image:linear-gradient(-180deg,#4dc9a7,#00a074)}.user-view .save-btn:active{box-shadow:inset 0 4px 10px rgba(0,0,0,.25)}.user-view .user-btn{padding:0 20px;color:#333;background-color:#eff3f6;background-image:linear-gradient(-180deg,#fafbfc,#eff3f6 90%)}.user-view .user-btn:active{box-shadow:inset 0 2px 5px rgba(0,0,0,.15)}.user-view .no-user{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:40px}.user-view .upload-avatar{position:relative}.user-view .upload-avatar button{width:100%}.user-view .upload-avatar .avatar-input{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0}","",{version:3,sources:["/Users/mac/Desktop/mine/NightCat/view/src/views/fe/user.vue"],names:[],mappings:"AAKA,WACE,aAAc,AAId,wBAAyB,AACrB,qBAAsB,AAClB,uBAAwB,AAChC,eAAiB,CAClB,AACD,kCARE,oBAAqB,AACrB,oBAAqB,AACrB,YAAc,CAaf,AAPD,uBAII,YAAa,AACb,aAAc,AACd,cAAgB,CACnB,AACD,8BACM,kBAAoB,CACzB,AACD,sBACI,mBAAoB,AAChB,WAAY,AACR,OAAQ,AAChB,mBAAoB,AAOZ,qBAAuB,CAClC,AACD,4DARI,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,4BAA6B,AAC7B,6BAA8B,AAC1B,yBAA2B,CAalC,AAVD,sCACM,kBAAmB,AACnB,mBAAoB,AAOZ,qBAAuB,CACpC,AACD,4CACQ,WAAY,AACZ,eAAgB,AAChB,iBAAmB,CAC1B,AACD,4CACQ,WAAY,AACZ,YAAa,AACb,gBAAiB,AACjB,eAAgB,AAChB,WAAY,AACZ,iBAAkB,AAClB,sBAAuB,AACvB,yBAA0B,AAC1B,sBAAuB,AACvB,kBAAmB,AACnB,2CAAiD,CACxD,AACD,kDACU,qBAAsB,AACtB,aAAc,AACd,uEAAkF,CAC3F,AACD,sDACU,YAAa,AACb,wBAA0B,CACnC,AACD,oDACQ,oBAAqB,AACrB,oBAAqB,AACrB,YAAc,CACrB,AACD,0DACU,yBAA2B,CACpC,AACD,2DACU,yBAA2B,CACpC,AACD,wBACI,YAAa,AACb,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,4BAA6B,AAC7B,6BAA8B,AAC1B,0BAA2B,AACvB,qBAAuB,CAClC,AACD,gCACM,YAAa,AACb,aAAc,AACd,kBAAmB,AACnB,kBAAoB,CACzB,AACD,qBACI,0BAA2B,AACvB,sBAAuB,AAC3B,eAAgB,AAChB,mBAAoB,AACpB,YAAa,AACb,WAAY,AACZ,sBAAuB,AACvB,yDAAqE,CACxE,AACD,4BACM,2CAAiD,CACtD,AACD,qBACI,eAAgB,AAChB,WAAY,AACZ,yBAA0B,AAC1B,6DAAoE,CACvE,AACD,4BACM,0CAAgD,CACrD,AACD,oBACI,oBAAqB,AACrB,oBAAqB,AACrB,aAAc,AACd,wBAAyB,AACrB,qBAAsB,AAClB,uBAAwB,AAChC,yBAA0B,AACtB,sBAAuB,AACnB,mBAAoB,AAC5B,cAAgB,CACnB,AACD,0BACI,iBAAmB,CACtB,AACD,iCACM,UAAY,CACjB,AACD,wCACM,kBAAmB,AACnB,MAAO,AACP,OAAQ,AACR,WAAY,AACZ,YAAa,AACb,SAAW,CAChB",file:"user.vue",sourcesContent:['\n@charset "UTF-8";\n/*\n * 基础色\n */\n.user-view {\n  height: 100vh;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  overflow: hidden;\n}\n.user-view .user-group {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    width: 800px;\n    padding: 20px;\n    margin: 200px 0;\n}\n.user-view .user-group .title {\n      margin-bottom: 12px;\n}\n.user-view .user-info {\n    -webkit-box-flex: 1;\n        -ms-flex: 1;\n            flex: 1;\n    margin-right: 120px;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column;\n}\n.user-view .user-info .user-info-item {\n      position: relative;\n      margin-bottom: 15px;\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-orient: vertical;\n      -webkit-box-direction: normal;\n          -ms-flex-direction: column;\n              flex-direction: column;\n}\n.user-view .user-info .user-info-item label {\n        width: 70px;\n        font-size: 14px;\n        margin-bottom: 5px;\n}\n.user-view .user-info .user-info-item input {\n        width: 100%;\n        height: 34px;\n        padding: 6px 8px;\n        font-size: 14px;\n        color: #333;\n        line-height: 20px;\n        vertical-align: middle;\n        background-color: #fafafa;\n        border: 1px solid #ddd;\n        border-radius: 4px;\n        box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.075);\n}\n.user-view .user-info .user-info-item input:focus {\n          border-color: #51a7e8;\n          outline: none;\n          box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.075), 0 0 5px rgba(81, 167, 232, 0.5);\n}\n.user-view .user-info .user-info-item input[disabled] {\n          opacity: .75;\n          background-color: #f1f1f1;\n}\n.user-view .user-info .user-info-item .has-btn-item {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n}\n.user-view .user-info .user-info-item .has-btn-item input {\n          border-radius: 3px 0 0 3px;\n}\n.user-view .user-info .user-info-item .has-btn-item button {\n          border-radius: 0 3px 3px 0;\n}\n.user-view .user-avatar {\n    width: 168px;\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n        -ms-flex-direction: column;\n            flex-direction: column;\n}\n.user-view .user-avatar .avatar {\n      width: 168px;\n      height: 168px;\n      border-radius: 3px;\n      margin-bottom: 10px;\n}\n.user-view .save-btn {\n    -ms-flex-item-align: start;\n        align-self: flex-start;\n    padding: 0 20px;\n    margin-bottom: 40px;\n    border: none;\n    color: #fff;\n    background-color: #eee;\n    background-image: linear-gradient(-180deg, #4dc9a7 0%, #00a074 100%);\n}\n.user-view .save-btn:active {\n      box-shadow: inset 0 4px 10px rgba(0, 0, 0, 0.25);\n}\n.user-view .user-btn {\n    padding: 0 20px;\n    color: #333;\n    background-color: #eff3f6;\n    background-image: linear-gradient(-180deg, #fafbfc 0%, #eff3f6 90%);\n}\n.user-view .user-btn:active {\n      box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.15);\n}\n.user-view .no-user {\n    display: -webkit-box;\n    display: -ms-flexbox;\n    display: flex;\n    -webkit-box-pack: center;\n        -ms-flex-pack: center;\n            justify-content: center;\n    -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n    font-size: 40px;\n}\n.user-view .upload-avatar {\n    position: relative;\n}\n.user-view .upload-avatar button {\n      width: 100%;\n}\n.user-view .upload-avatar .avatar-input {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      opacity: 0;\n}\n'],sourceRoot:""}])},293:function(e,i,n){var t=n(275);"string"==typeof t&&(t=[[e.i,t,""]]),t.locals&&(e.exports=t.locals);n(196)("428c87ea",t,!0)},546:function(e,i){e.exports={render:function(){var e=this,i=e.$createElement,n=e._self._c||i;return n("div",{staticClass:"user-view"},[e.userInfo?n("div",{staticClass:"user-group"},[n("div",{staticClass:"user-info"},[n("h1",{staticClass:"title"},[e._v("个人资料")]),e._v(" "),n("div",{staticClass:"user-info-item"},[n("label",{attrs:{for:"account"}},[e._v("账号：")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.account,expression:"userInfo.account"}],attrs:{id:"account",disabled:""},domProps:{value:e.userInfo.account},on:{input:function(i){i.target.composing||(e.userInfo.account=i.target.value)}}})]),e._v(" "),e.isSelf?e._e():n("div",{staticClass:"user-info-item"},[n("label",{attrs:{for:"email"}},[e._v("邮箱：")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.email,expression:"userInfo.email"}],attrs:{id:"email",disabled:""},domProps:{value:e.userInfo.email},on:{input:function(i){i.target.composing||(e.userInfo.email=i.target.value)}}})]),e._v(" "),n("div",{staticClass:"user-info-item"},[n("label",{attrs:{for:"profile"}},[e._v("概况：")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.profile,expression:"userInfo.profile"}],attrs:{id:"profile",disabled:!e.isSelf},domProps:{value:e.userInfo.profile},on:{input:function(i){i.target.composing||(e.userInfo.profile=i.target.value)}}})]),e._v(" "),n("div",{staticClass:"user-info-item"},[n("label",{attrs:{for:"location"}},[e._v("位置：")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.location,expression:"userInfo.location"}],attrs:{id:"location",disabled:!e.isSelf},domProps:{value:e.userInfo.location},on:{input:function(i){i.target.composing||(e.userInfo.location=i.target.value)}}})]),e._v(" "),n("div",{staticClass:"user-info-item"},[n("label",{attrs:{for:"github"}},[e._v("Github：")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.github,expression:"userInfo.github"}],attrs:{id:"github",disabled:!e.isSelf},domProps:{value:e.userInfo.github},on:{input:function(i){i.target.composing||(e.userInfo.github=i.target.value)}}})]),e._v(" "),n("div",{staticClass:"user-info-item"},[n("label",{attrs:{for:"website"}},[e._v("网站：")]),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.website,expression:"userInfo.website"}],attrs:{id:"website",disabled:!e.isSelf},domProps:{value:e.userInfo.website},on:{input:function(i){i.target.composing||(e.userInfo.website=i.target.value)}}})]),e._v(" "),e.isSelf?n("Btn",{staticClass:"save-btn",on:{click:e.updateUser}},[e._v("保存修改")]):e._e(),e._v(" "),e.isSelf?[n("h1",{staticClass:"title"},[e._v("绑定邮箱")]),e._v(" "),n("div",{staticClass:"user-info-item"},[e.isSelf?n("div",{staticClass:"has-btn-item"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.email,expression:"userInfo.email"}],attrs:{id:"email"},domProps:{value:e.userInfo.email},on:{input:function(i){i.target.composing||(e.userInfo.email=i.target.value)}}}),e._v(" "),n("Btn",{staticClass:"user-btn",on:{click:e.bindEmail}},[e._v("绑定邮箱")])],1):n("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.email,expression:"userInfo.email"}],attrs:{id:"email",disabled:""},domProps:{value:e.userInfo.email},on:{input:function(i){i.target.composing||(e.userInfo.email=i.target.value)}}})])]:e._e()],2),e._v(" "),n("div",{staticClass:"user-avatar"},[n("h1",{staticClass:"title"},[e._v("头像")]),e._v(" "),n("img",{staticClass:"avatar",attrs:{src:e.userInfo.avatar,alt:"avatar"}}),e._v(" "),n("span",{staticClass:"upload-avatar"},[e.isSelf?n("Btn",{staticClass:"user-btn upload-btn"},[e._v("上传新头像")]):e._e(),e._v(" "),n("input",{staticClass:"avatar-input",attrs:{type:"file",accept:"image/*"},on:{change:e.uploadAvatar}})],1)])]):n("div",{staticClass:"no-user"},[e._v("\n    没有这个人\n  ")])])},staticRenderFns:[]}}});
//# sourceMappingURL=7.738a70840856243b1ac8.js.map